<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta charset="utf-8">
    
    
    
    <title>啥？我写了个服务器 | noc的手记 | hello world</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    
    <meta name="theme-color" content="#77AAFF">
    
    
    <meta name="keywords" content="nginx,负载均衡">
    
    

    

    <!-- Baidu Push -->
<script>
	(function(){
		var bp = document.createElement('script');
		var curProtocol = window.location.protocol.split(':')[0];
		if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
		}
		else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
		}
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(bp, s);
	})();

	var _hmt = _hmt || [];
</script>


	<script src="//hm.baidu.com/hm.js?77018fff337dacf0c04f32a378791855"></script>


    
    <meta name="description" content="没想到我也是一个标题党  写在前面去年，利用业余时间以及所学知识建了人生中第一个网站，这个网站也就我用来平时写写东西。当然前期就是写后端交互代码，把后端代码写好的话，免不了要放在服务器上，既然放在服务器上，我们肯定也要部署Web服务器，目前市面上常用的两款Web服务器就是apache和NginX，在我了解了这两款服务器后，我坚决的选择了后者，那就是鼎鼎大名的NginX。">
<meta property="og:type" content="article">
<meta property="og:title" content="啥？我写了个服务器">
<meta property="og:url" content="https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/index.html">
<meta property="og:site_name" content="noc的手记">
<meta property="og:description" content="没想到我也是一个标题党  写在前面去年，利用业余时间以及所学知识建了人生中第一个网站，这个网站也就我用来平时写写东西。当然前期就是写后端交互代码，把后端代码写好的话，免不了要放在服务器上，既然放在服务器上，我们肯定也要部署Web服务器，目前市面上常用的两款Web服务器就是apache和NginX，在我了解了这两款服务器后，我坚决的选择了后者，那就是鼎鼎大名的NginX。">
<meta property="og:image" content="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1589347216122.png">
<meta property="og:image" content="http://lock2016.xyz/media/upload/NonCover/2020/05/13/u12973693652217576409fm26gp0.jpg">
<meta property="og:image" content="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1589349030919.png">
<meta property="og:image" content="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1.jpg">
<meta property="og:image" content="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1589350583198.png">
<meta property="article:published_time" content="2020-05-13T08:19:40.000Z">
<meta property="article:modified_time" content="2020-05-13T08:27:15.279Z">
<meta property="article:author" content="NonCover">
<meta property="article:tag" content="nginx">
<meta property="article:tag" content="负载均衡">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1589347216122.png">
    
        <link rel="alternate" type="application/atom+xml" title="noc的手记" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link id="style" rel="stylesheet" href="/css/style.css?v=3.0">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    
            
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>
    <aside id="menu"  class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" >
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="avatar">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname" id="name">NonCover</h5>
          
            <div id="mymotto" class="motto"></div>
          
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
              <li class="waves-block waves-effect">
                  <a href="/"  >
                    <i class="icon icon-lg icon-home"></i>
                    <span>主 页</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/archives"  >
                    <i class="icon icon-lg icon-archives"></i>
                    <span>归 档</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/categories"  >
                    <i class="icon icon-lg icon-th-list"></i>
                    <span>分 类</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/tags"  >
                    <i class="icon icon-lg icon-tags"></i>
                    <span>标 签</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/about"  >
                    <i class="icon icon-lg icon-smile-o"></i>
                    <span>关 于</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
      </ul>
      <ul class="nav2">
          
	      <li class="waves-block waves-effect">
              	<a href="mailto:3471949741@qq.com" target="_parent"title="Email" >
                  <i class="icon icon-lg icon-envelope-o envelope-o"></i>
                </a>
              </li>
          
	      <li class="waves-block waves-effect">
              	<a href="https://github.com/NonCover" target="_blank"title="Github" >
                  <i class="icon icon-lg icon-github github"></i>
                </a>
              </li>
          
	      <li class="waves-block waves-effect">
              	<a href="javascript:;" id="wechat_icon" title="欢迎关注公众号" >
                  <i class="icon icon-lg icon-weixin weixin"></i>
                </a>
              </li>
          
        
      </ul>
        
    </div>
  </div>
 
</aside>


    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">啥？我写了个服务器</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        <a href="../../atom.xml" target="_blank" class="header-icon waves-effect waves-circle waves-light" id="Rss">
            <i class="icon icon-lg icon-rss"></i>
        </a>
    </div>
</header>
<header class="content-header post-header">
    
    
    <div class="container fade-scale">
        <div id="myheader">
            <h1 class="title">
                
            </h1>
            <h5 class="subtitle">
                
                
            </h5>
        </div>
    </div>

</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#写在前面"><span class="post-toc-number">1.</span> <span class="post-toc-text">写在前面</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#关于Nginx（Engine-X）"><span class="post-toc-number">2.</span> <span class="post-toc-text">关于Nginx（Engine X）</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#正向代理"><span class="post-toc-number">3.</span> <span class="post-toc-text">正向代理</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#反向代理"><span class="post-toc-number">4.</span> <span class="post-toc-text">反向代理</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#正-反向代理的使用场景"><span class="post-toc-number">5.</span> <span class="post-toc-text">正&#x2F;反向代理的使用场景</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#负载均衡"><span class="post-toc-number">6.</span> <span class="post-toc-text">负载均衡</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-轮询法-Round-Robin"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">1. 轮询法(Round Robin)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-加权轮询法-Weight-Round-Robin"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">2. 加权轮询法(Weight Round Robin)</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#fq软件"><span class="post-toc-number">7.</span> <span class="post-toc-text">fq软件</span></a></li></ol>
        </nav>
    </aside>
   
<article id="post-啥？我写了个服务器"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">啥？我写了个服务器</h1>
        <div class="post-meta">
            <i class="icon icon-lg icon-calendar-o"></i>
            发表于
            <time class="post-time" title="2020-05-13 16:19:40" datetime="2020-05-13T08:19:40.000Z"  itemprop="datePublished">2020-05-13</time>

            <br id="mybreak"/>
            
	<i class="icon icon-lg icon-folder-o"></i>
	分类：<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a></li></ul>


            <i>·</i>
            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>次浏览
</span>


        </div>
        <div class="post-count-custom">
            <i class="icon icon-lg icon-comment-o"></i>
            阅读本文可能花费您&nbsp;<span class="post-count">12</span>&nbsp;分钟
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <blockquote>
<p>没想到我也是一个标题党</p>
</blockquote>
<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>去年，利用业余时间以及所学知识建了人生中<a href="http://lock2016.xyz/" target="_blank" rel="noopener">第一个网站</a>，这个网站也就我用来平时写写东西。当然前期就是写后端交互代码，把后端代码写好的话，免不了要放在服务器上，既然放在服务器上，我们肯定也要部署Web服务器，目前市面上常用的两款Web服务器就是apache和NginX，在我了解了这两款服务器后，我坚决的选择了后者，那就是鼎鼎大名的NginX。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1589347216122.png" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>

<p>按F12可以查看到我网站的请求头里就有我的代理服务器版本号。当然博思平台也用的是此款服务器。</p>
<p>总之，我们不妨先记住Nginx的几个优点，高并发，轻量级，部署简单快捷，百万级的访问量下，Nginx能够还能够保持它的性能，这也得益于它的代理策略。</p>
<h1 id="关于Nginx（Engine-X）"><a href="#关于Nginx（Engine-X）" class="headerlink" title="关于Nginx（Engine X）"></a>关于Nginx（Engine X）</h1><blockquote>
<p>nginx [engine x] is an HTTP and reverse proxy server, a mail proxy server, and a generic TCP/UDP proxy server, originally written by <a href="http://sysoev.ru/en/" target="_blank" rel="noopener">Igor Sysoev</a>. For a long time, it has been running on many heavily loaded Russian sites including <a href="http://www.yandex.ru/" target="_blank" rel="noopener">Yandex</a>, <a href="http://mail.ru/" target="_blank" rel="noopener">Mail.Ru</a>, <a href="http://vk.com/" target="_blank" rel="noopener">VK</a>, and <a href="http://www.rambler.ru/" target="_blank" rel="noopener">Rambler</a>. According to Netcraft, nginx served or proxied <a href="https://news.netcraft.com/archives/2020/04/08/april-2020-web-server-survey.html" target="_blank" rel="noopener">25.54% busiest sites in April 2020</a>. Here are some of the success stories: <a href="https://blogs.dropbox.com/tech/2017/09/optimizing-web-servers-for-high-throughput-and-low-latency/" target="_blank" rel="noopener">Dropbox</a>, <a href="https://openconnect.netflix.com/en/software/" target="_blank" rel="noopener">Netflix</a>, <a href="https://www.nginx.com/case-studies/nginx-wordpress-com/" target="_blank" rel="noopener">Wordpress.com</a>, <a href="http://blog.fastmail.fm/2007/01/04/webimappop-frontend-proxies-changed-to-nginx/" target="_blank" rel="noopener">FastMail.FM</a>.</p>
</blockquote>
<p>上面这段话出自Nginx官网，大致意思差不多就是Nginx这个服务器很多牛逼的互联网公司在用，</p>
<p>不过说到Nginx，那就要说到 伊戈尔·赛索耶夫 这个人，他是一名俄罗斯软件工程师，也就是Nginx的发明者，不得不说，毛子的编程水平也是一流。他在工作闲暇之余用C语言开发了这款闻名全球的轻量级高并发的Web服务器，Nginx不仅可以用作网站的服务器，还可以作为支持电子邮件的代理服务器。早期的淘宝就是用的Nginx来部署的（厉害吧），不过随着淘宝网后期的业务调整之类的种种原因，淘宝叫来了一群工程师，把Nginx的一些组件封装好，再加入一些特性，开发出了一款<strong>全新</strong>的Web服务器<strong>Tengine</strong>，估计淘宝现在用的是自家的服务器吧。</p>
<p>不过悲惨的是，伊戈尔·赛索耶夫在去年被俄罗斯警方逮捕，随着一起被逮捕的有另外一个人，也是Nginx的开发者之一，具体原因大家可以百度一下，为了节省篇幅就不废话了。</p>
<p>说到这，Nginx官网介绍的是，这款服务器是一个反向代理服务器，那么什么是反向代理？说反向代理之前，我先来说一下正向代理吧！此文的重点来了</p>
<h1 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h1><p>先看一个直观图（图片来源网络）</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://lock2016.xyz/media/upload/NonCover/2020/05/13/u12973693652217576409fm26gp0.jpg" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>

<p>Proxy server就是我们的代理服务器，Server就是我们需要访问的服务器</p>
<p>举个例子：某天小明在写代码的时候发现了一个Bug，他想上谷歌搜一下这个Bug是怎么回事，但是无论怎么搜只能搜到如下界面</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1589349030919.png" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>

<p>后来，小明知道了学校的服务器是可以访问Google的，他就向学校的服务器发送了一个请求，学校的服务器收到了请求后，再去访问Google，随后再把Google返回的数据返回给小明，就这样小明成功的访问到了Google。</p>
<p>例子中很容易就理解了正向代理服务器的过程，学校的服务器就作为一个代理服务器，而Google就是我们想要访问的目标服务器，而我们是无法直接访问，只能通过代理服务器去访问，然后再把数据返回给我们。</p>
<p>正向代理我们是需要手动去设置代理服务器的ip地址的，在Win下就可以直接设置代理服务器，有兴趣的可以百度一下如何设置。我就不讲如何设置了。</p>
<p>那说完了正向代理，下面就要讲Nginx所用到的反向代理模式了。</p>
<p>累死我了，喝口茶<del>~</del></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1.jpg" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>

<h1 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h1><p>说到反向代理，我们先讲一下服务器群组，玩过饥荒的同学知道，如果我们自己开房间玩的话，房主所在的电脑将被饥荒作为一个服务器，所有玩家都将连接到你的电脑上来进行联机游玩，要知道当初我电脑性能并不是很好，记得一个房间最多5人还是8人来着，刚开始还好，游戏正常有序的进行下去，越到后面，随着加入游戏的人数增多，后期资源，地图的扩大，导致了我的电脑宕机了，没错直接就崩了，从那之后我就再也没有自己开过房间玩，到后面就游戏就吃灰了（哈哈，我玩游戏玩不长，总想着玩新游戏）。</p>
<p>不够这也说明电脑以及服务器的性能是执行程序效率的好坏关键之一。话不多说，还是先来看一图</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://lock2016.xyz/media/upload/NonCover/2020/05/13/1589350583198.png" alt="img" title="">
                </div>
                <div class="image-caption">img</div>
            </figure>



<p>我们再思考一个问题，现实生活中，无论你的服务器性能再好，你终究只是一台服务器，然而我们却要处理数以千万记的请求，就像<a href="http://lock2016.xyz/blog/article/www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>一样，每天都会有千万ip在进行着访问服务器的过程，可一个服务器怎么可能处理的过来，这个时候反向代理服务器就出来了，例如上图，当我们去访问baidu的时候，<a href="http://lock2016.xyz/blog/article/www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>这个域名指向的服务就作为一个代理服务器，代理服务器利用一种算法（负载均衡算法，下文会讲）将每一个请求转发到其LAN下的某一台具体的服务器，接下来这台服务器处理相关的请求，随后返回给客户端。就这样简单。</p>
<h1 id="正-反向代理的使用场景"><a href="#正-反向代理的使用场景" class="headerlink" title="正/反向代理的使用场景"></a>正/反向代理的使用场景</h1><p>其实正向代理估计很多人都已经知晓他的用途了，没错，那就是翻墙，俗话说的好，不会翻墙的程序员不是一个好bloger，咳咳~~，当然墙外的世界很精彩，还是要告诉大家，之所以会有墙的存在，是因为国外的一些反动分子，诸如废青之类的影响到了我们祖国的新一代就不好了，当然我们翻墙看一看外面的世界也要谨慎发言才好。平时我翻墙的话用的就是ssr，俗称酸酸乳，下面我会给出软件。</p>
<p>那反向代理主要就是用来为一群服务器提供负载均衡，保持性能资源利用最大化。</p>
<h1 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h1><p>本来负载均衡我是打算另开一个文章来详细说的，眼看开学在即，我也没有多少时间收集资料，这里我就简单的描述一下，以及用Java简单模拟一下负载均衡算法。</p>
<p>负载均衡的英语是 <strong>load balance</strong>，目的是用来使每一台服务器负载量保持均衡，比如说，我有十台服务器，我不可能让第一台服务器处理一百个请求，第二台服务器处理1个请求吧，所以就有了算法来处理这些问题。</p>
<p>我这里只说两种常用的负载均衡算法</p>
<h2 id="1-轮询法-Round-Robin"><a href="#1-轮询法-Round-Robin" class="headerlink" title="1. 轮询法(Round Robin)"></a>1. 轮询法(Round Robin)</h2><p>所谓轮询法，轮询，轮询，光听名字就知道，轮着来呗，假如我们有10台服务器，一台代理服务器，突然有10个ip发来了请求，代理服务器就把这10个请求依次交给这10台服务器，每个服务器都达到了负载均衡，只需处理一个请求即可。光听描述简单吧。我相信你能够懂，代码我就不写了，一个循环而已。</p>
<p>方法总是伴随着问题而来，负载是达到了均衡，可是真的达到了吗？我再举一个例子，假如有10个人，其中有高有矮，有壮有瘦，在他们的面前有1000斤的东西要搬到仓库去，如果按照轮询法的策略的话，每个人只需要搬100斤的东西，可是又高又壮的人明明可以般200斤，矮的人最多只能般50斤。这样的话就造成了资源浪费以及超负荷负载。那么接下来讲的就是另一种负载均衡算法了。</p>
<h2 id="2-加权轮询法-Weight-Round-Robin"><a href="#2-加权轮询法-Weight-Round-Robin" class="headerlink" title="2. 加权轮询法(Weight Round Robin)"></a>2. 加权轮询法(Weight Round Robin)</h2><p>没错，我要写代码了，之所以上面不写，主要是这两个算法不难，但是在服务器内部实现的话要考虑很多因素，待会儿再说这个问题。</p>
<p>其实我们只需要把每一台服务器加上一个权值，这个权的大小代表着这个服务器的性能好坏。</p>
<p>我们先实现一个类，该类的签名如下：</p>
<blockquote>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoundRobin</span> </span>{}  </span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<p>然后还有一些类属性：</p>
<blockquote>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务器群的ip地址</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;String&gt; ips;</span><br><span class="line"><span class="comment">// 每台服务器对应的权值</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;Integer&gt; weight;</span><br><span class="line"><span class="comment">// 每台服务器的负载量</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> TreeMap&lt;String, Integer&gt; map;</span><br><span class="line"><span class="comment">// 服务器的个数</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count;</span><br><span class="line"><span class="comment">// 打印服务器的ip地址</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getIps</span><span class="params">()</span></span>{}</span><br><span class="line"><span class="comment">// 模仿负载均衡算法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadBalancing</span><span class="params">(<span class="keyword">int</span> req)</span></span>{}</span><br><span class="line"><span class="comment">// 打印每台服务器的负载量</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServerChargeNumber</span><span class="params">()</span></span>{}</span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<p>最重要的就是负载均衡算法方法了，我们先来看一下是如何实现的</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadBalancing</span><span class="params">(<span class="keyword">int</span> req)</span> </span>{    </span><br><span class="line">    <span class="keyword">int</span> pos = <span class="number">0</span>;    </span><br><span class="line">    <span class="keyword">while</span> (req &gt; <span class="number">0</span>){     </span><br><span class="line">        <span class="comment">// 当pos轮询到最后一台服务器的时候，又从0开始轮询</span></span><br><span class="line">        <span class="keyword">if</span> (pos == count) pos = <span class="number">0</span>; </span><br><span class="line">        <span class="comment">// 当前转发的服务器ip地址</span></span><br><span class="line">        String currServerIp = ips.get(pos);</span><br><span class="line">        <span class="comment">// 当前权值</span></span><br><span class="line">        <span class="keyword">int</span> currServerWeight = weight.get(pos);        </span><br><span class="line">        <span class="comment">/**         </span></span><br><span class="line"><span class="comment">        * 如果当前服务器的权为5的话，必须给当前服务器分配5个请求才能给下一份服务器分配         </span></span><br><span class="line"><span class="comment">        */</span>        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> currServerChargeNumber = <span class="number">0</span>;currServerChargeNumber &lt;= currServerWeight; ++currServerChargeNumber){          </span><br><span class="line">            <span class="comment">// 模拟转发请求。这里记录一下服务器收到的请求数</span></span><br><span class="line">            map.put(currServerIp, map.get(currServerIp) + <span class="number">1</span>);            </span><br><span class="line">            <span class="comment">// 请求减一</span></span><br><span class="line">            req--;        </span><br><span class="line">        }        </span><br><span class="line">        <span class="comment">// 对应加一</span></span><br><span class="line">        pos++;    </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>其实加权轮询法比轮询法多加了一个权值而已，假如我们有三台服务器，有10个ip发来请求，这三台服务器的权值分别为5， 3， 2，根据权值大小，第一台服务器要处理5个请求，在轮询到下一个服务器，第二台就要处理3个请求，接下来第三台肯定就要处理两个请求了，就这样我们才能做到真正的负载均衡。根据服务器的硬件性能分配不同的权值，在根据权值大小去分配请求。</p>
<p>多说无益，我们直接模拟发起请求吧。</p>
<p>先看完整的算法代码：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.round_robin;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoundRobin</span> </span>{    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;String&gt; ips;    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;Integer&gt; weight;    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> TreeMap&lt;String, Integer&gt; map;    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count;    </span><br><span class="line">    <span class="keyword">static</span> {        </span><br><span class="line">        <span class="comment">// 初始化 ip地址        </span></span><br><span class="line">        ips = <span class="keyword">new</span> ArrayList&lt;&gt;();        </span><br><span class="line">        map = <span class="keyword">new</span> TreeMap&lt;&gt;();        </span><br><span class="line">        weight = <span class="keyword">new</span> ArrayList&lt;&gt;();        </span><br><span class="line">        count = <span class="number">0</span>;        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; ++i) {            </span><br><span class="line">            String ip = <span class="string">"192.168.1."</span> + i;                               ips.add(ip);            </span><br><span class="line">            map.put(ip, <span class="number">0</span>);            </span><br><span class="line">            count++;        </span><br><span class="line">        }        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">9</span>; i &gt;= <span class="number">1</span>; --i)                                    weight.add(i);    </span><br><span class="line">    }    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RoundRobin</span><span class="params">()</span> </span>{}    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getIps</span><span class="params">()</span> </span>{        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; ++i) {            </span><br><span class="line">            System.out.println(<span class="string">"ip:"</span> + ips.get(i) + <span class="string">" 权重:"</span> + weight.get(i));        </span><br><span class="line">        }    </span><br><span class="line">    }    </span><br><span class="line">    <span class="comment">/**     </span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> req 向请求服务器发起请求次数    </span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> 返回代理的ip地址    </span></span><br><span class="line"><span class="comment">    */</span>    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadBalancing</span><span class="params">(<span class="keyword">int</span> req)</span> </span>{        </span><br><span class="line">        <span class="keyword">int</span> pos = <span class="number">0</span>;        </span><br><span class="line">        <span class="keyword">while</span> (req &gt; <span class="number">0</span>){            </span><br><span class="line">            <span class="keyword">if</span> (pos == count) pos = <span class="number">0</span>;            </span><br><span class="line">            String currServerIp = ips.get(pos);            </span><br><span class="line">            <span class="keyword">int</span> currServerWeight = weight.get(pos);            </span><br><span class="line">            <span class="comment">/**            </span></span><br><span class="line"><span class="comment">            * 如果当前服务器的权为5的话，必须给当前服务器分配5个请求才能给下一份服务器分配             </span></span><br><span class="line"><span class="comment">            */</span>            </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> currServerChargeNumber = <span class="number">0</span>; currServerChargeNumber &lt;= currServerWeight; ++currServerChargeNumber) {                </span><br><span class="line">                map.put(currServerIp, map.get(currServerIp) + <span class="number">1</span>);                </span><br><span class="line">                req--;            </span><br><span class="line">            }            </span><br><span class="line">            pos++;        </span><br><span class="line">        }    </span><br><span class="line">    }    </span><br><span class="line">    <span class="comment">/**    </span></span><br><span class="line"><span class="comment">    * 打印每台服务器的负载量     </span></span><br><span class="line"><span class="comment">    */</span>    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServerChargeNumber</span><span class="params">()</span> </span>{        </span><br><span class="line">        Set&lt;String&gt; set = map.keySet();        </span><br><span class="line">        <span class="keyword">for</span> (String ip : set)            </span><br><span class="line">            System.out.println(ip + <span class="string">" : "</span> + map.get(ip));   </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>代码较长，其实自己写一遍更好理解。</p>
<p>模拟发起请求就放在主函数了。</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>{    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{        </span><br><span class="line">        RoundRobin roundRobin = <span class="keyword">new</span> RoundRobin();\</span><br><span class="line">        <span class="comment">// roundRobin.getIps();         </span></span><br><span class="line">        <span class="comment">// 模拟发起10000次请求</span></span><br><span class="line">        roundRobin.loadBalancing(<span class="number">10000</span>);                            roundRobin.getServerChargeNumber();    </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>每台服务器处理的请求如下：</p>
<blockquote>
<p>192.168.1.1 : 1860</p>
<p>192.168.1.2 : 1665</p>
<p>192.168.1.3 : 1480</p>
<p>192.168.1.4 : 1295</p>
<p>192.168.1.5 : 1110</p>
<p>192.168.1.6 : 925</p>
<p>192.168.1.7 : 740</p>
<p>192.168.1.8 : 555</p>
<p>192.168.1.9 : 370</p>
</blockquote>
<p>ok，很简单吧，是不是瞬间感觉自己也能开发出一台服务器了。哈哈哈，不过正式服务器内部代码肯定不像我这样，还要处理客户端发来的数据，还要检测每台服务器是否能够正常通讯，总之神功不是一天就练成了，了解其内部处理原理才能够帮助我们写出更好的代码。</p>
<p>加油吧骚年！！！</p>
<h1 id="fq软件"><a href="#fq软件" class="headerlink" title="fq软件"></a>fq软件</h1><p>链接：<a href="https://pan.baidu.com/s/1ujgOh_EGhyUakAOCBEIgDA" target="_blank" rel="noopener">https://pan.baidu.com/s/1ujgOh_EGhyUakAOCBEIgDA</a> 提取码：ydi7</p>
<blockquote>
<p>如何使用就自己琢磨了。可以自己搭建ssr，也可以上网买ssr，我只提供软件而已</p>
</blockquote>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-05-13T08:27:15.279Z" itemprop="dateUpdated">2020-05-13 16:27:15</time>
</span>


        
        原文链接：<a href="/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="external">https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/</a>
        
    </div>
    <footer>
        <div onclick="location.href='https://NonCover.github.io'">
            <img src="/img/avatar.jpg" alt="NonCover">
            <a>NonCover</a>
        </div>
    </footer>
</blockquote>

        
    <div class="page-reward">
        <nav class="myreward">
            <a id="rewardBtn" href="javascript:;"><span>打&nbsp;赏</span><span>装成好像很多人打赏的样子</span></a>
        </nav>
    </div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" rel="tag">负载均衡</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/&title=《啥？我写了个服务器》 — noc的手记&pic=https://NonCover.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/&title=《啥？我写了个服务器》 — noc的手记&source=记录在学习道路上以及生活上的一些收获" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《啥？我写了个服务器》 — noc的手记&url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/&via=https://NonCover.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/05/14/%E4%BD%8D%E8%BF%90%E7%AE%97%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/" id="post-prev" class="post-nav-link">
        <h4 class="title" >
          上一篇：位运算知识点总结
        </h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/05/10/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E6%B1%82%E5%B9%B3%E6%96%B9%E6%A0%B9/" id="post-next" class="post-nav-link">
        <h4 class="title" data-hover="下一篇：如何优雅的求平方根">下一篇：如何优雅的求平方根</h4>
      </a>
    </div>
  
</nav>



    
    
<section class="comments" id="comments">
    <div id="gitment_thread"></div>
    <link rel="stylesheet" href="//unpkg.com/gitment/style/default.css">
    <script src="//unpkg.com/gitment/dist/gitment.browser.js"></script>
    <script>
        var gitment = new Gitment({
            owner: '',
            repo: '',
            oauth: {
                client_id: '',
                client_secret: '',
            },
        })
        gitment.render('comments')
    </script>
</section>


    
<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var gitalk = new Gitalk({
            clientID: '',
            clientSecret: '',
            repo: '',
            owner: '',
            admin: ['']
        });
        gitalk.render('gitalk-container');
    </script>
</section>


    


</article>

</div>

        <footer class="footer">
    <div class="footer-content">
        <span class="power">
            <i class="icon icon-lg icon-copyright"></i>
            2016
            <i class="icon icon-lg icon-heart"></i>
            <a href="https://NonCover.github.io">lock2016</a>
            <br/>
            Power by
            <a href="https://hexo.io/" target="_blank" rel="external nofollow">Hexo</a>&nbsp;·&nbsp;
            Theme
            <a class="tomotoeslink" href="https://github.com/tomotoes/hexo-theme-tomotoes/" target="_blank" rel="external nofollow">tomotoes</a>
        </span>

        <br/>

        <span id="RunTime" style="color:#a7a7a2;"></span>
        <br/>

        <span>
            
	<i class="icon icon-lg icon-user">
<span id="busuanzi_container_site_uv" style='display:none'>
       访问用户：<span id="busuanzi_value_site_uv"></span>
    </span>人</i>
    ·
    <i class="icon icon-lg icon-eye">
    <span id="busuanzi_container_site_pv" style='display:none'>
      访问次数：<span id="busuanzi_value_site_pv"></span>
    </span>次
    </i>


        </span>
        <br/>

        <span class="license">This blog is licensed under a <a rel="license noopener" rel="external nofollow noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

    </main>
    
        
<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        <span>为五斗米折腰(支付宝)</span>
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" data-img="/img/alipay.png" alt="打赏二维码">
        </div>
        
        <i class="icon icon-caret-up"></i>
    </div>
</div>


    
    <div id="wechat" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h4 class="reward-title">
        <i class="icon icon-quote-left"></i>
        <span>欢迎关注微信公众号！</span>
        <i class="icon icon-quote-right"></i>
    </h4>
    <img id="wechat_img" data-img="/img/wechat.jpg" alt="欢迎您的关注！">
</div>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/&title=《啥？我写了个服务器》 — noc的手记&pic=https://NonCover.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/&title=《啥？我写了个服务器》 — noc的手记&source=记录在学习道路上以及生活上的一些收获" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《啥？我写了个服务器》 — noc的手记&url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/&via=https://NonCover.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p class="wechatshare">扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://noncover.github.io/2020/05/13/%E5%95%A5%EF%BC%9F%E6%88%91%E5%86%99%E4%BA%86%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8/" alt="微信分享二维码">
</div>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?77018fff337dacf0c04f32a378791855";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


    <!-- waves按钮特效 -->
<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<!-- 主题配置脚本 -->
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };
</script>

<!-- jquery -->
<script src="/js/jquery.min.js?v=3.0"></script>

<!-- 搜索 -->

<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item waves-block waves-effect" onclick="location.href='{path}'">
    <div class="title ellipsis" title="{title}">{title}</div>
</li>
</template>


<!-- main博客脚本 -->
<script src="/js/main.min.js?v=3.0" ></script>

<!-- 动画&配置 -->
<script src="/js/script.min.js?v=3.0" ></script>

<!-- 脚本管理 -->
<script>

if(window.innerWidth > 800){
	/* 3D标题 */
	$(".content-header").on("mousemove", threedee);

	/* 底部追随鼠标 */
	$(".footer").hover(2);

	/* gotop键的涟漪 */
	$("#gotop").hover(1);

	/* 赞赏的粒子雨 */
	$("#reward").hover(3);

	/* 微信公众号的底部渲染 */
	$("#wechat").hover(4);

    /* 标题跳动 */
    $(".archivestitle").bumpyText();

	/* 图片点击放大 */
	const postimg = jQuery(".post-content img:not(.github-emoji)");
	postimg.on("click",function(){

		mask.classList.add("in");
		main.classList.add("Mask");
		menu.classList.add("Mask");
		var myimg = this.cloneNode(true);
		myimg.classList.add("imgShow");

		setTimeout(function(){
			jQuery(myimg).animate({
				opacity:"1"
			},1000);
		},0);

		document.body.appendChild(myimg);

		myimg.onclick=function(){
			document.body.removeChild(myimg);
			mask.classList.remove("in");
			main.classList.remove("Mask");
			menu.classList.remove("Mask");
		};

	});

}

/* 名字跳动 */
$("#name").bumpyText();

/* 网站运行时间 */
setInterval(function () {
	setTime("2020/4/24");
}, 1000);

/* 文章块的淡出 */
postshow();

/* 座右铭 */

    elasticText({
        id: "mymotto",
        duration: 100,
        effact: "easeOut",
        content: ""
    });



/* 粘贴提示 */
G($(".post-content"), location.href, "NonCover");


/* 控制台 */
if (window.console && window.console.log) {
	setTimeout(function () {
		console.log("\n %c 一个坏掉的番茄 %c  © Simon Ma  http://tomotoes.com \n\n", "color:#FFFFFB;background:#1abc9c;padding:5px 0;border-radius:.5rem 0 0 .5rem;", "color:#FFFFFB;background:#080808;padding:5px 0;border-radius:0 .5rem .5rem 0;");
	}, 0);
}

</script>




<!-- 公式渲染 -->



<!-- 不蒜子 -->

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script>


</body>
</html>
